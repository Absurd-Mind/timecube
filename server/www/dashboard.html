<!DOCTYPE html>
<html lang="de">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Zeiterfassungswürfel - Übersicht</title>

	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="css/apexcharts.css">
	<link rel="stylesheet" href="css/dashboard.css">

</head>

<body>


	<div id="wrapper">

		<div class="content-area">
			<div class="container-fluid">
				<div class="main">
					<!-- Header row -->
					<div class="row mt-4 mb-4">
							<div id="header"></div>
					</div>
					<div class="row headerline mt-4 mb-4">
						<div class="col-md-4">
							<div class="box">
								<div><b>Letzte Aktualisierung</b></div>
								<div id="information"></div>
								<div class="inline" id="voltage"></div>
								<div class="inline" id="voltagehist"></div>
							</div>
						</div>
						<div class="col-md-8">
							<div class="box">
								<div>Derzeitiger Batteriestatus</div>
								<div id="foo"></div>
							</div>
						</div>
					</div>
					<div class="row mt-3 mb-4">
						<div class="col-md-6">
							<div class="box">
								<ul class="nav nav-tabs tabable" id="myTab" role="tablist">
									<li class="nav-item"><a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Gestern</a></li>
									<li class="nav-item"><a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Diese</a></li>
									<li class="nav-item"><a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false">Contact</a></li>
									  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Dropdown</a>
    <div class="dropdown-menu">
      <a class="dropdown-item" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Action</a>
      <a class="dropdown-item" href="#">Another action</a>
      <a class="dropdown-item" href="#">Something else here</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="#">Separated link</a>
    </div>
  </li>
								</ul>
								<div class="tab-content" id="myTabContent">
									<div class="tab-pane  show active" id="home" role="tabpanel" aria-labelledby="home-tab">home</div>
									<div class="tab-pane " id="profile" role="tabpanel" aria-labelledby="profile-tab"></div>
									<div class="tab-pane " id="contact" role="tabpanel" aria-labelledby="contact-tab">contact</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row mt-3 mb-4">
						<div class="col-md-6">
							<div class="box">
								<ul class="nav nav-tabs tabable" id="myTab" role="tablist">
									<li class="nav-item dropdown">
										<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Filter</a>
										<div class="dropdown-menu">
											<a class="dropdown-item" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Keiner</a>
											<div class="dropdown-divider"></div>
											<a class="dropdown-item" href="#">Another action</a>
											<a class="dropdown-item" href="#">Something else here</a>
											<a class="dropdown-item" href="#">Separated link</a>
										</div>
									</li>
									<li><input type="range" class="custom-range" min="1" max="52" id="customRange1"></li>
								</ul>
								<div class="tab-content" id="myTabContent">
									<div class="tab-pane  show active" id="home" role="tabpanel" aria-labelledby="home-tab">home</div>
									<div class="tab-pane " id="profile" role="tabpanel" aria-labelledby="profile-tab"></div>
									<div class="tab-pane " id="contact" role="tabpanel" aria-labelledby="contact-tab">contact</div>
								</div>
							</div>
						</div>
					</div>
					<!-- Bar and Heatmap Graphs -->
					<div class="row mt-3 mb-4">
						<div class="col-md-6">
							<div class="tab">
								<button class="bar_tablinks" onclick="openBar(event, 'week')" id="bar_default">Letzte 7 Tage</button>
								<button class="bar_tablinks" onclick="openBar(event, 'month')">Letzte 30 Tage</button>
								<button class="bar_tablinks" onclick="openBar(event, 'thisyear')">Dieses Jahr</button>
								<div class="box">
									<div id="bar_week" class="bar_tabcontent"> </div>
									<div id="bar_month" class="bar_tabcontent"> </div>
									<div id="bar_thisyear" class="bar_tabcontent"></div>
								</div>
							</div>
						</div>
						<div class="col-md-6">
							<div class="tab">
								<button class="heat_tablinks" onclick="openHeatmap(event, 'week')" id="heat_default">Letzte 7 Tage</button>
								<button class="heat_tablinks" onclick="openHeatmap(event, 'month')">Letzte 30 Tage</button>
								<div class="box">
									<div id="heat_week" class="heat_tabcontent"> </div>
									<div id="heat_month" class="heat_tabcontent">Hier könnte Ihr Graph stehen!</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Pie Chart -->
					<div class="row">
						<div class="col-md-12">
							<div class="box">
								<div id="full"></div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col">
							<div class="box">
								<div id="pie3"> </div>
							</div>
						</div>
						<div class="col">
							<div class="box">
								<div id="pie4"> </div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col">
							<div class="box">
								<div id="pie5"> </div>
							</div>
						</div>
						<div class="col">
							<div class="box">
								<div id="pie6"> </div>
							</div>
						</div>
						<div class="col">
							<div class="box">
								<div id="pie7"> </div>
							</div>
						</div>
					</div>

				</div>

			</div>
		</div>
	</div>

	<script src="js/jquery.min.js"></script>
	<script src="js/apexcharts.min.js"></script>
	<script src="js/bootstrap.bundle.min.js"></script>
	<script src="data.js"></script>
	<script src="js/helper.js"></script>
	<script src="js/render.js"></script>
	<script src="js/locale.js"></script>


	<script>
	// Header
	if (data.name == "") {
		data.name = "Unbekannt";
	}
	document.getElementById("header").innerHTML =
		"<h1>Zeiterfassungswürfel von " + data.name + "</h1>";

	// Informations
	document.getElementById("information").innerHTML = lastUpdate(data);


renderChart("foo", generateDayTimeBar(data, "2019-02-01", "2019-05-03"));
renderChart("voltagehist", generateVoltageLine(data, "2019-04-01"));

renderChart("pie6", generateWorkCircle(data));
	// Voltage
	renderVoltage(data, "voltage", );

	// Bar Chart: default last week
	// Pre-render graphs
	renderBar(data, "bar_week", "week");
	renderBar(data, "bar_month", "month");
	renderBar(data, "bar_thisyear", "thisyear");

	document.getElementById("bar_default").click();
	function openBar(event, option) {
		var tabcontent, tablinks;
		var tabcontent = document.getElementsByClassName("bar_tabcontent");
		for (var i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
		}
		tablinks = document.getElementsByClassName("bar_tablinks");
		for (var i = 0; i < tablinks.length; i++) {
			tablinks[i].className = tablinks[i].className.replace(" active", "");
		}
		document.getElementById("bar_" + option).style.display = "block";

		event.currentTarget.className += " active";

	}

	// Heatmap: default last week
	// Pre-render graphs
	renderHeatmap(data, "heat_week", "week");
	renderHeatmap(data, "head_month", "month");

	document.getElementById("heat_default").click();
	function openHeatmap(event, option) {
		var tabcontent, tablinks;
		var tabcontent = document.getElementsByClassName("heat_tabcontent");
		for (var i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
		}
		tablinks = document.getElementsByClassName("heat_tablinks");
		for (var i = 0; i < tablinks.length; i++) {
			tablinks[i].className = tablinks[i].className.replace(" active", "");
		}
		document.getElementById("heat_" + option).style.display = "block";

		event.currentTarget.className += " active";

	}
	
	// todo: dropdown mit limit auf seite, ggf eingabefeld fuer anzahl wochen bei weekheatmap
renderChart("full",generateYearHeatmap(data));
//renderChart("full",generateWeekHeatmap(data,"2019-03-28"));
	// Pie Charts
	//renderPie(data, "pie", 300);
	renderChart("home", generatePie(data, "2019-04-01", "2019-05-02"));


	// Use Tabs
	$('.tabable a').on('click', function (e) {
		e.preventDefault();
		$(this).tab('show');
	})


	renderChartLazy("profile", function(){ return generatePie(data, "2019-05-02", "2019-05-03"); });

	$('a[data-toggle="tab"]').on('hide.bs.tab', function (e) {
		var obj = $(e.target.hash);
		if (obj[0].chart !== undefined)
			obj[0].chart.destroy();
		obj[0].style.display="none";
	})
	
	$('a[data-toggle="tab"]').on('show.bs.tab', function (e) {
		var obj = $(e.target.hash);
		obj[0].style.display="block";
		obj.trigger("chart", [ obj ]);
	})
	</script>
</body>

</html>

